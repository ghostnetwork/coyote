<!doctype html>
<html>
  <head>
    <title>coyote</title>

    <meta charset='utf-8'/>

    <style type="text/css">
      * { margin:0; padding:0; } /* to remove the top and left whitespace */
      html, body { width:100%; height:100%; } /* just to be sure these are full screen*/
      canvas { display:block; } /* To remove the scrollbars */
      body { 
        background-color: PapayaWhip;
        margin: 0; 
        width:100%; height:100%;
      }
      #canvas {  
        background-color: SteelBlue;
      }
      #buttons { visibility: hidden; }
      #editor { 
        display: inline;
        font-family: 'Courier New';
        font-size: 16pt;
        left: 50px;
        position: absolute;
        top: 600px;
        visibility: hidden;
      }
    </style>

    <script type="text/javascript" src="src/event/EventDispatcher.js"></script>
    <script type="text/javascript" src="src/geometry/Size.js"></script>
    <script type="text/javascript" src="src/geometry/Point.js"></script>
    <script type="text/javascript" src="src/geometry/Rectangle.js"></script>
    <script type="text/javascript" src="src/tools/Pulse.js"></script>
    <script type="text/javascript" src="src/display/Graphics.js"></script>
    <script type="text/javascript" src="src/display/FullsizeCanvas.js"></script>
    <script type="text/javascript" src="src/display/Box.js"></script>

    <script type="text/javascript">
      var fullsizeCanvas;
      var graphics;

      function initialize() {
        // fullsizeCanvas = FullsizeCanvas.create().initialize(testFullSizeCanvasDrawing);
        fullsizeCanvas = FullsizeCanvas.create().initialize();

        testGraphics();
        testEventDispatcher();
        testPulse();
        testBox();
        testSize();
      }

      function testGraphics() {
        var canvas = document.getElementById('canvas');
        graphics = fullsizeCanvas.graphics;
      }

      function testFullSizeCanvasDrawing() {
        if (graphics) {
          var ctx = graphics.context;
          ctx.strokeStyle = "#FFA500";

          //-----------------------------------------------------------------------------
          var lingrad = ctx.createLinearGradient(0,0,0,150);
          lingrad.addColorStop(0, '#00ABEB');
          lingrad.addColorStop(0.5, '#fff');
          lingrad.addColorStop(0.5, '#26C000');
          lingrad.addColorStop(1, '#fff');
          //-----------------------------------------------------------------------------

          graphics.drawFilledRect(new Rectangle(25,25,100,100), lingrad);
          graphics.clearRect(new Rectangle(45,45,60,60));
          graphics.strokeRect(new Rectangle(50,50,50,50));

          roundedRect(ctx, 200, 25, 200, 200, 10);

          graphics.drawFilledRect(new Rectangle(25,200,100,100), '#774499');
        }
      }

      function roundedRect(ctx,x,y,width,height,radius){
        ctx.beginPath();
        ctx.moveTo(x,y+radius);
        ctx.lineTo(x,y+height-radius);
        ctx.quadraticCurveTo(x,y+height,x+radius,y+height);
        ctx.lineTo(x+width-radius,y+height);
        ctx.quadraticCurveTo(x+width,y+height,x+width,y+height-radius);
        ctx.lineTo(x+width,y+radius);
        ctx.quadraticCurveTo(x+width,y,x+width-radius,y);
        ctx.lineTo(x+radius,y);
        ctx.quadraticCurveTo(x,y,x,y+radius);
        ctx.stroke();
      }

      function testEventDispatcher() {
        var emitter = new EventDispatcher();
        var listener = function(event) {console.log('event: ' + event);};
        emitter.addEventListener('click', listener);
        emitter.emit('click', 'cluck');
        emitter.removeEventListener('click', listener);
        emitter.emit('click', 'cluck');
      }

      function testPulse() {
        var pulse = new Pulse();
        pulse.addPulseEventListener(function() {
          fullsizeCanvas.refresh();
        });

        var period = 100;
        var numTimes = 4;
        pulse.start(period);
        setTimeout(function() {
          pulse.stop();
        }, period * numTimes);
      }

      function testBox() {
        // var bounds = new Rectangle(25,100,100,100);
        var bounds = new Rectangle(10,50,100,100);
        var fillStyle = '#774422';
        var box = new Box(bounds, fillStyle);
        fullsizeCanvas.addChild(box);
      }

      function testSize() {
        var bounds = new Rectangle(25,400,100,100);
        var size = bounds.size;
        console.log('size: ' + size);
      }
     </script>

  </head>
  <body onload='initialize();'>
    <div><canvas id="canvas"></canvas></div>
    <div><input type="text" id="editor"/></div>
  </body>
</html>
