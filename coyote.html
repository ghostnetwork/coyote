<!doctype html>
<html>
  <head>
    <title>coyote</title>

    <meta charset='utf-8'/>

    <style type="text/css">
      * { margin:0; padding:0; } /* to remove the top and left whitespace */
      html, body { width:100%; height:100%; } /* just to be sure these are full screen*/
      canvas { display:block; } /* To remove the scrollbars */
      body { 
        background-color: PapayaWhip;
        margin: 0; 
        width:100%; height:100%;
      }
      #canvas {  
        background-color: SteelBlue;
      }
      #buttons { visibility: hidden; }
      #editor { 
        display: inline;
        font-family: 'Courier New';
        font-size: 16pt;
        left: 50px;
        position: absolute;
        top: 600px;
        visibility: hidden;
      }
    </style>

    <script type="text/javascript" src="node_modules/verdoux/src/predicates.js"></script>
    <script type="text/javascript" src="lib/underscore.js"></script>
    <script type="text/javascript" src="src/bagOfTricks.js"></script>
    <script type="text/javascript" src="src/event/EventDispatcher.js"></script>
    <script type="text/javascript" src="src/geometry/Size.js"></script>
    <script type="text/javascript" src="src/geometry/Point.js"></script>
    <script type="text/javascript" src="src/geometry/Rectangle.js"></script>
    <script type="text/javascript" src="src/tools/Pulse.js"></script>
    <script type="text/javascript" src="src/display/Displayable.js"></script>
    <script type="text/javascript" src="src/display/DragDrop.js"></script>
    <script type="text/javascript" src="src/display/Graphics.js"></script>
    <script type="text/javascript" src="src/display/FullsizeCanvas.js"></script>
    <script type="text/javascript" src="src/display/Box.js"></script>

    <script type="text/javascript">
      var fullsizeCanvas;
      var graphics;

      function initialize() {
        fullsizeCanvas = FullsizeCanvas.create().initialize();
        testDragDrop();
        addHierarchicalBoxes();
        fullsizeCanvas.refresh();
      }

      function testPulse() {
        var pulse = new Pulse();
        pulse.addPulseEventListener(function() {
          fullsizeCanvas.refresh();
        });

        var period = 100;
        var numTimes = 4;
        pulse.start(period);
        setTimeout(function() {
          pulse.stop();
        }, period * numTimes);
      }

      function testDragDrop() {
        var bounds = new Rectangle(150, 50, 200, 200);
        var fillStyle = '#229977';
        var spec = {name:'big.box', bounds:bounds, fillStyle:fillStyle};
        var box = Box.create(spec);

        fullsizeCanvas.addChild(box);
        fullsizeCanvas.dragDrop.registerDropTarget(box);

        addDraggableBox();
      }

      function addDraggableBox() {
        var bounds = new Rectangle(50,125,50,50);
        var color = '#774422';
        var fillStyle = colorWithAlpha(color, 0.85);
        var spec = {name:'draggable.box', bounds:bounds, fillStyle:fillStyle};
        var box = Box.create(spec);

        fullsizeCanvas.addChild(box);
      }

      function addHierarchicalBoxes() {
        var containerBounds = Rectangle.create(400, 50, 400, 300);
        var color = '#224477';
        var fillStyle = colorWithAlpha(color, 0.85);
        var spec = {name:'container.box', bounds:containerBounds, fillStyle:fillStyle};
        var containerBox = Box.create(spec);

        var bounds = new Rectangle(410,60,25,25);
        var color = '#447722';
        var fillStyle = colorWithAlpha(color, 0.85);
        var spec = {name:'inside.box', bounds:bounds, fillStyle:fillStyle};
        var box = Box.create(spec);
        containerBox.addChild(box);

        fullsizeCanvas.addChild(containerBox);
      }

      function testSize() {
        var bounds = new Rectangle(25,400,100,100);
        var size = bounds.size;
      }
     </script>

  </head>
  <body onload='initialize();'>
    <div><canvas id="canvas"></canvas></div>
    <div><input type="text" id="editor"/></div>
  </body>
</html>

<!-- 

        // testGraphics();
        // testEventDispatcher();
        // testSize();

      function testGraphics() {
        var canvas = document.getElementById('canvas');
        graphics = fullsizeCanvas.graphics;
      }

      function testFullSizeCanvasDrawing() {
        if (graphics) {
          var ctx = graphics.context;
          ctx.strokeStyle = "#FFA500";

          //-----------------------------------------------------------------------------
          var lingrad = ctx.createLinearGradient(0,0,0,150);
          lingrad.addColorStop(0, '#00ABEB');
          lingrad.addColorStop(0.5, '#fff');
          lingrad.addColorStop(0.5, '#26C000');
          lingrad.addColorStop(1, '#fff');
          //-----------------------------------------------------------------------------

          graphics.drawFilledRect(new Rectangle(25,25,100,100), lingrad);
          graphics.clearRect(new Rectangle(45,45,60,60));
          graphics.strokeRect(new Rectangle(50,50,50,50));

          roundedRect(ctx, 200, 25, 200, 200, 10);

          graphics.drawFilledRect(new Rectangle(25,200,100,100), '#774499');
        }
      }

      function roundedRect(ctx,x,y,width,height,radius){
        ctx.beginPath();
        ctx.moveTo(x,y+radius);
        ctx.lineTo(x,y+height-radius);
        ctx.quadraticCurveTo(x,y+height,x+radius,y+height);
        ctx.lineTo(x+width-radius,y+height);
        ctx.quadraticCurveTo(x+width,y+height,x+width,y+height-radius);
        ctx.lineTo(x+width,y+radius);
        ctx.quadraticCurveTo(x+width,y,x+width-radius,y);
        ctx.lineTo(x+radius,y);
        ctx.quadraticCurveTo(x,y,x,y+radius);
        ctx.stroke();
      }

      function testEventDispatcher() {
        var emitter = new EventDispatcher();
        var listener = function(event) {return('event: ' + event);};
        emitter.addEventListener('click', listener);
        emitter.emit('click', 'cluck');
        emitter.removeEventListener('click', listener);
        emitter.emit('click', 'cluck');
      }


 -->